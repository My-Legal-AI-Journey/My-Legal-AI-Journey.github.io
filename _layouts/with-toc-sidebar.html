---
layout: default
---

<style>
  /* 视口单位靠边方案 */
  .page-container-wrapper {
    display: flex;
    max-width: 1200px;
    margin: 0 auto;
    gap: 15px;
    padding: 20px;
    align-items: flex-start;
    position: relative;
  }
  
  /* 侧边栏固定在视口左侧 */
  .sidebar-fixed {
    width: 230px;
    flex-shrink: 0;
    background: #f8f9fa;
    border-radius: 0 6px 6px 0;
    padding: 15px;
    position: sticky;
    top: 20px;
    max-height: calc(100vh - 40px);
    overflow-y: auto;
    font-size: 13px;
    /* 关键：使用calc计算靠边位置 */
    margin-left: calc(-50vw + 50% + 60px);
    box-shadow: 2px 0 10px rgba(0,0,0,0.1);
  }
  
  .content-original {
    flex: 1;
    min-width: 0;
  }
  
  .sidebar-title {
    font-size: 14px;
    font-weight: 600;
    margin: 0 0 12px 0;
    padding-bottom: 8px;
    border-bottom: 1px solid #e1e4e8;
    color: #24292e;
  }
  
  .sidebar-nav {
    list-style: none;
    padding: 0;
    margin: 0 0 15px 0;
  }
  
  .sidebar-nav li {
    margin-bottom: 6px;
    display: flex;
    align-items: center;
  }
  
  .sidebar-nav a {
    display: block;
    padding: 6px 8px;
    color: #586069;
    text-decoration: none;
    border-radius: 3px;
    transition: all 0.2s ease;
    line-height: 1.3;
    font-size: 12px;
  }
  
  .sidebar-nav a:hover {
    background: #0366d6;
    color: white;
  }
  
  .breadcrumb-arrow {
    margin: 0 5px;
    color: #d1d5da;
    font-size: 12px;
  }
  
  .toc-list {
    list-style: none;
    padding: 0;
    margin: 0;
  }
  
  .toc-item {
    margin-bottom: 4px;
  }
  
  .toc-link {
    display: block;
    padding: 4px 8px;
    color: #586069;
    text-decoration: none;
    border-radius: 3px;
    transition: all 0.2s ease;
    line-height: 1.3;
    font-size: 12px;
  }
  
  .toc-link:hover {
    background: #0366d6;
    color: white;
  }
  
  .toc-level-2 {
    padding-left: 12px;
    font-size: 11px;
  }
  
  .toc-level-3 {
    padding-left: 20px;
    font-size: 11px;
    color: #6a737d;
  }
  
  @media (max-width: 768px) {
    .page-container-wrapper {
      flex-direction: column;
    }
    .sidebar-fixed {
      width: 100%;
      position: static;
      margin-left: 0;
    }
  }
</style>

<div class="page-container-wrapper">
  <!-- 修复的侧边栏 - 更靠左 -->
  <aside class="sidebar-fixed">
    <!-- 修复的面包屑导航 -->
    <div class="sidebar-title">🔙 快速导航</div>
    <ul class="sidebar-nav" id="breadcrumb-nav">
      <!-- 动态生成完整的面包屑 -->
    </ul>
    
    <!-- 本页目录 -->
    <div class="sidebar-title">📑 本页目录</div>
    <div id="page-toc-container">
      <!-- 动态生成 -->
    </div>
  </aside>
  
  <!-- 主内容区 - 完全保持原主题样式 -->
  <div class="content-original">
    {{ content }}
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // 修复的面包屑导航生成
  generateFixedBreadcrumb();
  
  // 生成页面目录
  generateTOC();
  
  // 设置平滑滚动
  setupSmoothScrolling();
});

// 智能面包屑导航 - 包含所有层级并使用页面标题
function generateFixedBreadcrumb() {
  const breadcrumbNav = document.getElementById('breadcrumb-nav');
  const currentPath = window.location.pathname;
  const pageTitle = document.title.replace(' - My Legal AI Journey', '').replace(' | My Legal AI Journey', ''); // 移除网站后缀
  
  let breadcrumbHTML = '';
  
  // 总是显示首页
  breadcrumbHTML += '<li><a href="/">🏠 首页</a></li>';
  
  // 构建完整的面包屑路径，过滤掉空值和index.html等
  const pathSegments = currentPath.split('/').filter(segment => 
    segment && segment !== 'index.html' && !segment.endsWith('.html')
  );
  
  let accumulatedPath = '';
  
  // 为每个路径段创建面包屑项
  pathSegments.forEach((segment, index) => {
    accumulatedPath += '/' + segment;
    
    let displayName = getDisplayName(segment);
    const isLast = index === pathSegments.length - 1;
    
    // 如果是最后一项且没有特殊显示名称，尝试使用页面标题
    if (isLast && displayName === segment.charAt(0).toUpperCase() + segment.slice(1).replace(/-/g, ' ')) {
      displayName = pageTitle || displayName;
    }
    
    // 添加箭头分隔符（除了最后一项）
    if (!isLast) {
      breadcrumbHTML += `<li><a href="${accumulatedPath}/">${displayName}</a><span class="breadcrumb-arrow">›</span></li>`;
    } else {
      // 最后一项不加链接，表示当前页面
      breadcrumbHTML += `<li><span style="padding: 6px 8px; color: #24292e; font-weight: 500;">${displayName}</span></li>`;
    }
  });
  
  breadcrumbNav.innerHTML = breadcrumbHTML;
}

// 显示名称映射函数
function getDisplayName(segment) {
  const nameMap = {
    'legal-notes': '📚 法学笔记',
    'civil-law': '⚖️ 民法笔记', 
    'intellectual-property': '💡 知识产权法',
    'general-theory': '📖 民法总论',
    'obligation-contract': '📝 债与合同法',
    'property-law': '🏠 物权法',
    'family-inheritance': '👨‍👩‍👧‍👦 婚姻家庭与继承法',
    'personality-rights': '👤 人格权法',
    'tort-law': '⚔️ 侵权法',
    'copyright': '📄 著作权法',
    'patent': '🔬 专利法',
    'trademark': '🏷️ 商标法',
    'ai-notes': '🤖 AI学习笔记',
    'projects': '🚀 项目实践',
    'about': 'ℹ️ 关于本站',
    'contact': '📞 联系方式'
  };
  
  return nameMap[segment.toLowerCase()] || 
         segment.charAt(0).toUpperCase() + segment.slice(1).replace(/-/g, ' ');
}

function generateTOC() {
  const mainContent = document.querySelector('.content-original');
  const headings = mainContent.querySelectorAll('h2, h3, h4');
  const tocContainer = document.getElementById('page-toc-container');
  
  if (headings.length === 0) {
    tocContainer.innerHTML = '<p style="color: #6a737d; font-size: 11px; padding: 0 8px; margin: 0;">本页暂无标题</p>';
    return;
  }
  
  let tocHTML = '<ul class="toc-list">';
  
  headings.forEach((heading, index) => {
    const level = parseInt(heading.tagName.substring(1));
    const id = heading.id || `heading-${index}`;
    heading.id = id;
    
    const text = heading.textContent.trim();
    const levelClass = `toc-level-${level}`;
    
    tocHTML += `
      <li class="toc-item">
        <a href="#${id}" class="toc-link ${levelClass}">${text}</a>
      </li>
    `;
  });
  
  tocHTML += '</ul>';
  tocContainer.innerHTML = tocHTML;
}

function setupSmoothScrolling() {
  const links = document.querySelectorAll('.toc-link');
  links.forEach(link => {
    link.addEventListener('click', function(e) {
      e.preventDefault();
      const href = this.getAttribute('href');
      const targetElement = document.querySelector(href);
      if (targetElement) {
        targetElement.scrollIntoView({ 
          behavior: 'smooth',
          block: 'start'
        });
      }
    });
  });
}
</script>
